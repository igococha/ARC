ls
pwd
dir
matplot
mu <- 1.0
ti = replicate(6,c(0,cumsum(rexp(25,mu))))
rexp(25,mu)
cumsum(rexp(25,mu))
ti
k <- replicate(ncol(ti),1:nrow(ti)-1)
k
matplot(ti,k,type="s",xlab="t",ylab="D(t)",lty=1
)
1
k <- 0:25;
k
d <- 12
d
sample <- dpois(k,d)
sample
barplot(sample, names.arg=k,xlab="k",ylab="Pr(k|d=12)")
install.packages("rcolgem", repos="http://R-Forge.R-project.org")
install.packages("~/z/imperial/builds/rcolgem/",repos=NULL,type="source")
install.packages("ape")
install.packages("deSolve")
install.packages("inline")
install.packages("Rcpp")
install.packages("RcppArmadillo")
install.packages("~/z/imperial/builds/rcolgem/",repos=NULL,type="source")
getwd()
getwd()
setwd("~/z/imperial")
getwd()
setwd("~/z/imperial/eclipsewd")
setwd("~/z/imperial/eclipsews")
setwd("~/z/imperial/eclipsews/ARC/examlpes")
setwd("~/z/imperial/eclipsews/ARC/examples")
setwd("~/z/imperial/eclipsews/ARC/examples/simseq0/test5")
log.data <- read.table("ucld_hpc_logs/10.ucld.5.log", sep="\t", header=TRUE)
log.data
nrows
numrows
dim(log.data)
log.data[1]
log.data[1 ,]
log.data[1:3 ,]
nrow(log.data)
n <- nrow(log.data)
n
0.1*n
as.integer(0.1*n)
n <- nrow(log.data)#
  s <- as.integer(0.1*n)
log.data <- log.data[s:n, ]
log.data[1,]
log.data[2,]
tmrca.all <- read.csv("tmrca.tab", header = FALSE)[[1]]#
arc.dir <- "arc_hpc_logs/"#
ucld.dir <- "ucld_hpc_logs/"#
last.sample <- 2010
df.rates <- data.frame(matrix(ncol=4,nrow=0))#
df.tmrca <- data.frame(matrix(ncol=5,nrow=0))
df.rates <- data.frame(matrix(ncol=4,nrow=0))#
df.tmrca <- data.frame(matrix(ncol=5,nrow=0))
for(tree in seq(1,100)) {#
  # row <- c()#
  tmrca.true <- tmrca.all[tree]#
  ucld.file <-  paste(ucld.dir,tree,".ucld.5.log",sep='')#
  # ucld samples#
  log.data <- read.table(ucld.file,sep="\t", header=TRUE)#
  n <- nrow(log.data)#
  s <- as.integer(0.1*n)#
  log.data <- log.data[s:n, ]#
  ucld.rates <- log.data["ucldMean"][[1]]#
  urate.mean <- mean(ucld.rates)#
  urate.sd <- sd(ucld.rates)#
  ucld.tmrcas <- last.sample - log.data["TreeHeight"][[1]]#
  utmrca.mean <- mean(ucld.tmrcas)#
  utmrca.sd <- sd(ucld.tmrcas)#
  # arc samples#
  arc.file <- paste(arc.dir,tree,".arc.5.log",sep='')#
  log.data <- read.table(arc.file,sep="\t", header=TRUE)#
   n <- nrow(log.data)#
  s <- as.integer(0.1*n)#
  log.data <- log.data[s:n, ]#
  arc.rates <- log.data["rateMean"][[1]]#
  arate.mean <- mean(arc.rates)#
  arate.sd <-  sd(arc.rates)#
  arc.tmrcas <- last.sample - log.data["TreeHeight"][[1]]#
  atmrca.mean <- mean(arc.tmrcas)#
  atmrca.sd <- sd(arc.tmrcas)#
  rates.row <- c(urate.mean, urate.sd, arate.mean, arate.sd)#
  df.rates <- rbind(df.rates, rates.row)#
  tmrca.row <- c(tmrca.true, utmrca.mean, utmrca.sd,  atmrca.mean, atmrca.sd)#
  df.tmrca <- rbind(df.tmrca, tmrca.row)#
  print(rates.row)#
}
colnames(df.rates) <- c("urate.mean","urate.sd","arate.mean","arate.sd")#
colnames(df.tmrca) <- c("tmrca.true", "utmrca.mean", "utmrca.sd",#
                        "atmrca.mean","atmrca.sd")#
write.csv(df.rates, file="stats_rates.csv", row.names=FALSE)#
#
write.csv(df.tmrca, file="stats_tmrca.csv", row.names=FALSE)
